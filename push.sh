#!/bin/bash
# ================================================
# ğŸš€ è‡ªåŠ¨æäº¤å¹¶æ¨é€æ‰€æœ‰ä¿®æ”¹
# ç”¨æ³•ï¼š
#   ./push_all.sh "ä½ çš„ commit ä¿¡æ¯"
# å¦‚æœä¸ä¼ å‚æ•°ï¼Œä¼šä½¿ç”¨é»˜è®¤æ—¶é—´æˆ³ä¿¡æ¯ã€‚
# ================================================

set -e

# è·å– commit ä¿¡æ¯
if [ -z "$1" ]; then
  msg="auto commit: $(date '+%Y-%m-%d %H:%M:%S')"
else
  msg="$1"
fi

# æ˜¾ç¤ºå½“å‰åˆ†æ”¯
branch=$(git symbolic-ref --short HEAD)
echo "ğŸ“¦ å½“å‰åˆ†æ”¯: $branch"

# æ·»åŠ ä¿®æ”¹
git add -A

# æäº¤
git commit -m "$msg" || echo "âš ï¸ æ²¡æœ‰æ”¹åŠ¨éœ€è¦æäº¤"

# æ¨é€
git push origin "$branch"

echo "âœ… å·²æ¨é€è‡³è¿œç¨‹ä»“åº“ ($branch)"

